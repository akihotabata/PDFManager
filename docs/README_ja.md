# PDFManager - 日本語README

## 概要
PDFManager は、PDF の結合・分割・ページ編集を **ローカル環境** で安全に行える Windows 向けデスクトップアプリです。  
PySide6(Qt) を用いた操作しやすい GUI、pypdf と PyMuPDF を使った高速で安定した処理を備えています。

---

## 主な機能

### 結合
- 任意フォルダ（サブフォルダ含む）から PDF を一括読み込み
- 自然順/日付/サイズでソート
- ドラッグ&ドロップで並び替え、選択削除、全消去
- 1つの PDF に結合（必要に応じて各ファイル名をブックマーク化）
- 進捗バーとログ表示、暗号化 PDF は自動スキップ

### 分割
- 1ページずつ / Nページごと / カスタム範囲（例: `1-3,5,7-10`）
- 出力先・プレフィックス・連番桁数・開始番号を指定可能

### ページ編集
- 選択ページの削除 / 抽出 / 回転 / 複製 / 挿入
- プレビュー（PyMuPDF）：拡大縮小、幅に合わせる、全体表示
- プレビューは `pymupdf` がインストールされていない場合は自動的に無効化されます

---

## 必要環境
- Windows 10 / 11
- Python 3.10 以上
- 依存パッケージ：`PySide6`, `pypdf`, `pymupdf`

> 依存は `tools/requirements.txt` から一括インストールできます。

---

## セットアップと起動

### 1) スクリプトで自動セットアップ（推奨）
リポジトリ直下の `tools/run.bat` をダブルクリックします。  
はじめて起動すると仮想環境の作成と依存インストールを自動で行い、そのまま GUI を起動します。

### 2) 手動セットアップ
```bat
python -m venv venv
venv\Scripts\activate
pip install -r tools\requirements.txt
python src\pdf_manager_app.py
```

---

## 使い方（概要）

1. 「結合」タブ  
   - フォルダを選択 → 「PDFを読み込む」 → 左リストで順番調整 → 出力先を指定 → 「結合を実行」  
2. 「分割」タブ  
   - 分割元 PDF を選択 → 分割モードを指定 → 出力パラメータを設定 → 「分割を実行」  
3. 「ページ編集」タブ  
   - PDF を選択 → ページ一覧から対象を選ぶ → 右のボタンで編集 → 「上書き保存」または「別名で保存」  

補足：暗号化 PDF は自動スキップ（空パスワードで解除可能な場合は試行）。エラーはログに記録されます。

---

## よくある質問（FAQ）

- **Q. プレビューが表示されません。**  
  A. `pip install pymupdf` が未実行の可能性があります。`tools/requirements.txt` に含まれているため、`run.bat` を使うと自動で導入されます。

- **Q. 巨大な PDF を扱うと時間がかかる／落ちる。**  
  A. 一時的に他アプリを閉じてメモリを確保してください。サブ範囲での分割→結合も有効です。

- **Q. 暗号化 PDF を結合したい。**  
  A. パスワード解除が必要です。本ツールはパスワードを求めません（解除不可のものはスキップ）。

- **Q. 実行ファイル（EXE）で配布したい。**  
  A. `docs/EXE化手順書_Windows.md` を参照してください。署名の付与は別途証明書が必要です。

---

## ライセンス
MIT License
