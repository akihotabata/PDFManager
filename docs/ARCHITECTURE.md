# ARCHITECTURE

## 目的
ローカル環境で PDF の「結合・分割・ページ編集」を安全かつ直感的に行う Windows デスクトップアプリ。

## 主要技術
- UI: PySide6 (Qt for Python)
- PDF 読み書き: pypdf (結合・分割)
- プレビュー: PyMuPDF (fitz)（未導入時は自動で非表示）
- 並列処理: QThread（重い I/O を UI スレッドから分離）

## 画面構成
- タブ1: 結合  
  - フォルダ選択、ソート、一覧、順序入替、出力指定、ブックマーク付与
- タブ2: 分割  
  - 1ページずつ / Nページごと / 範囲（1-3,5,7-10）と出力設定
- タブ3: ページ編集  
  - ページ一覧（左）＋プレビュー（右）＋操作ボタン群（削除・抽出・回転・複製・挿入）

## データフロー（結合）
1. 入力フォルダを走査して PDF を収集（オプション: 再帰）  
2. ソート後、UI リストにバインド  
3. 実行時に別スレッド（MergeWorker）が順次読み込み → pypdf で統合  
4. ログ・進捗をシグナルで UI に通知 → 最終ファイルを保存

## 例外設計
- 暗号化 PDF は空パスワード解除を試み、失敗時はスキップしログへ記録
- プレビュー描画失敗は UI をブロックせず通知のみ
- 保存/上書き時は OS による失敗（権限/ロック）をダイアログで明示

## 拡張余地
- サムネイル一覧（複数ページの同時プレビュー）
- ページのドラッグ&ドロップ移動（編集タブ）
- 履歴/アンドゥ、タブ間のドラッグ&ドロップ
- 設定保存（INI/JSON）とプロファイル切替

## ビルド/実行
- 実行: `tools/run.bat`
- 依存: `tools/requirements.txt`
- EXE 化: `tools/build_exe.bat`（PyInstaller）
